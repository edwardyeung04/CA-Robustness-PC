{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"d17e5c4f","executionInfo":{"status":"ok","timestamp":1701841345045,"user_tz":480,"elapsed":25426,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"271a6bed-e060-4f7d-fea3-3d62d7fd1e5e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n","/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project\n"]}],"source":["# This mounts your Google Drive to the Colab VM.\n","from google.colab import drive\n","drive.mount('/content/drive')\n","\n","# TODO: Enter the foldername in your Drive where you have saved the unzipped\n","# assignment folder, e.g. 'cse493g1/assignments/assignment1/'\n","FOLDERNAME = 'project/'\n","assert FOLDERNAME is not None, \"[!] Enter the foldername.\"\n","\n","# Now that we've mounted your Drive, this ensures that\n","# the Python interpreter of the Colab VM can load\n","# python files from within it.\n","import sys\n","sys.path.append('/content/drive/My Drive/{}'.format(FOLDERNAME))\n","\n","# This downloads the CIFAR-10 dataset to your Drive\n","# if it doesn't already exist.\n","#%cd /content/drive/My\\ Drive/$FOLDERNAME/cse493g1/datasets/\n","#!bash get_datasets.sh\n","%cd /content/drive/My\\ Drive/$FOLDERNAME\n","#!pip install git+https://github.com/fra31/auto-attack\n","#!git clone --recurse-submodules https://github.com/jiachens/ModelNet40-C.git\n"],"id":"d17e5c4f"},{"cell_type":"code","source":["import torch\n","print(torch.__version__)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UR3ttxs1IK52","executionInfo":{"status":"ok","timestamp":1701841365129,"user_tz":480,"elapsed":5156,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"a82ff803-6a1d-4ac0-dc6b-5c5efe771862"},"id":"UR3ttxs1IK52","execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["2.1.0+cu118\n"]}]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":47998,"status":"ok","timestamp":1701841414565,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"},"user_tz":480},"id":"PIVJX8-LohA3","outputId":"936d2319-d3dc-4c89-a04d-b17e6f7cf991"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c\n","Collecting etw_pytorch_utils (from -r requirements.txt (line 1))\n","  Cloning https://github.com/imankgoyal/etw_pytorch_utils.git (to revision v1.1.1) to /tmp/pip-install-3r80sqet/etw-pytorch-utils_10656b4b83fb4812bdd7ed70d1119829\n","  Running command git clone --filter=blob:none --quiet https://github.com/imankgoyal/etw_pytorch_utils.git /tmp/pip-install-3r80sqet/etw-pytorch-utils_10656b4b83fb4812bdd7ed70d1119829\n","  Running command git checkout -q 7c5b5df0696cd1876eeccb3b4b4609e4b675e293\n","  Resolved https://github.com/imankgoyal/etw_pytorch_utils.git to commit 7c5b5df0696cd1876eeccb3b4b4609e4b675e293\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting enum34 (from -r requirements.txt (line 2))\n","  Downloading enum34-1.1.10-py3-none-any.whl (11 kB)\n","Requirement already satisfied: future in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 3)) (0.18.3)\n","Requirement already satisfied: h5py in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 4)) (3.9.0)\n","Collecting progressbar2==3.50.0 (from -r requirements.txt (line 5))\n","  Downloading progressbar2-3.50.0-py2.py3-none-any.whl (51 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m51.0/51.0 kB\u001b[0m \u001b[31m1.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting tensorboardX (from -r requirements.txt (line 6))\n","  Downloading tensorboardX-2.6.2.2-py2.py3-none-any.whl (101 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m101.7/101.7 kB\u001b[0m \u001b[31m4.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting yacs==0.1.6 (from -r requirements.txt (line 7))\n","  Downloading yacs-0.1.6-py3-none-any.whl (9.6 kB)\n","Requirement already satisfied: python-utils>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from progressbar2==3.50.0->-r requirements.txt (line 5)) (3.8.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from progressbar2==3.50.0->-r requirements.txt (line 5)) (1.16.0)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.10/dist-packages (from yacs==0.1.6->-r requirements.txt (line 7)) (6.0.1)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from etw_pytorch_utils->-r requirements.txt (line 1)) (1.23.5)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from etw_pytorch_utils->-r requirements.txt (line 1)) (1.11.4)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from etw_pytorch_utils->-r requirements.txt (line 1)) (4.66.1)\n","Collecting visdom (from etw_pytorch_utils->-r requirements.txt (line 1))\n","  Downloading visdom-0.2.4.tar.gz (1.4 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.4/1.4 MB\u001b[0m \u001b[31m28.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting statistics (from etw_pytorch_utils->-r requirements.txt (line 1))\n","  Downloading statistics-1.0.3.5.tar.gz (8.3 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorboardX->-r requirements.txt (line 6)) (23.2)\n","Requirement already satisfied: protobuf>=3.20 in /usr/local/lib/python3.10/dist-packages (from tensorboardX->-r requirements.txt (line 6)) (3.20.3)\n","Requirement already satisfied: typing-extensions>3.10.0.2 in /usr/local/lib/python3.10/dist-packages (from python-utils>=2.3.0->progressbar2==3.50.0->-r requirements.txt (line 5)) (4.5.0)\n","Requirement already satisfied: docutils>=0.3 in /usr/local/lib/python3.10/dist-packages (from statistics->etw_pytorch_utils->-r requirements.txt (line 1)) (0.18.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (2.31.0)\n","Requirement already satisfied: tornado in /usr/local/lib/python3.10/dist-packages (from visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (6.3.2)\n","Collecting jsonpatch (from visdom->etw_pytorch_utils->-r requirements.txt (line 1))\n","  Downloading jsonpatch-1.33-py2.py3-none-any.whl (12 kB)\n","Requirement already satisfied: websocket-client in /usr/local/lib/python3.10/dist-packages (from visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (1.6.4)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (3.2.1)\n","Requirement already satisfied: pillow in /usr/local/lib/python3.10/dist-packages (from visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (9.4.0)\n","Collecting jsonpointer>=1.9 (from jsonpatch->visdom->etw_pytorch_utils->-r requirements.txt (line 1))\n","  Downloading jsonpointer-2.4-py2.py3-none-any.whl (7.8 kB)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->visdom->etw_pytorch_utils->-r requirements.txt (line 1)) (2023.11.17)\n","Building wheels for collected packages: etw_pytorch_utils, statistics, visdom\n","  Building wheel for etw_pytorch_utils (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for etw_pytorch_utils: filename=etw_pytorch_utils-1.1.1-py3-none-any.whl size=18538 sha256=9c2edcf5f052996e9c72fd7d1f460cbc56f3ad714d52ce3fc6a01a1f58b05b48\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-yuh75bd5/wheels/fa/dc/ca/fb93adf8e7b235a76cb62bdc29e1ce5d3fc32588109465402c\n","  Building wheel for statistics (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for statistics: filename=statistics-1.0.3.5-py3-none-any.whl size=7436 sha256=d4202401c8f9c137c7a2323672b53c5480940bcc18a6297c606cb80f63d710b4\n","  Stored in directory: /root/.cache/pip/wheels/59/bd/aa/41ad56fbb723d36e457b5be74feb992cdac2855a6999ba34a1\n","  Building wheel for visdom (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for visdom: filename=visdom-0.2.4-py3-none-any.whl size=1408194 sha256=f01dbc47ac735a1624d7486732e94d73bc1e0347ca596c4ebd02cd744a3abb5b\n","  Stored in directory: /root/.cache/pip/wheels/42/29/49/5bed207bac4578e4d2c0c5fc0226bfd33a7e2953ea56356855\n","Successfully built etw_pytorch_utils statistics visdom\n","Installing collected packages: enum34, yacs, tensorboardX, statistics, jsonpointer, progressbar2, jsonpatch, visdom, etw_pytorch_utils\n","  Attempting uninstall: progressbar2\n","    Found existing installation: progressbar2 4.2.0\n","    Uninstalling progressbar2-4.2.0:\n","      Successfully uninstalled progressbar2-4.2.0\n","Successfully installed enum34-1.1.10 etw_pytorch_utils-1.1.1 jsonpatch-1.33 jsonpointer-2.4 progressbar2-3.50.0 statistics-1.0.3.5 tensorboardX-2.6.2.2 visdom-0.2.4 yacs-0.1.6\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["enum"]}}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Collecting open3d\n","  Downloading open3d-0.17.0-cp310-cp310-manylinux_2_27_x86_64.whl (420.5 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m420.5/420.5 MB\u001b[0m \u001b[31m3.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.18.0 in /usr/local/lib/python3.10/dist-packages (from open3d) (1.23.5)\n","Collecting dash>=2.6.0 (from open3d)\n","  Downloading dash-2.14.2-py3-none-any.whl (10.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m10.2/10.2 MB\u001b[0m \u001b[31m117.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: werkzeug>=2.2.3 in /usr/local/lib/python3.10/dist-packages (from open3d) (3.0.1)\n","Collecting nbformat==5.7.0 (from open3d)\n","  Downloading nbformat-5.7.0-py3-none-any.whl (77 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m77.1/77.1 kB\u001b[0m \u001b[31m9.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting configargparse (from open3d)\n","  Downloading ConfigArgParse-1.7-py3-none-any.whl (25 kB)\n","Collecting ipywidgets>=8.0.4 (from open3d)\n","  Downloading ipywidgets-8.1.1-py3-none-any.whl (139 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m139.4/139.4 kB\u001b[0m \u001b[31m18.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting addict (from open3d)\n","  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)\n","Requirement already satisfied: pillow>=9.3.0 in /usr/local/lib/python3.10/dist-packages (from open3d) (9.4.0)\n","Requirement already satisfied: matplotlib>=3 in /usr/local/lib/python3.10/dist-packages (from open3d) (3.7.1)\n","Requirement already satisfied: pandas>=1.0 in /usr/local/lib/python3.10/dist-packages (from open3d) (1.5.3)\n","Requirement already satisfied: pyyaml>=5.4.1 in /usr/local/lib/python3.10/dist-packages (from open3d) (6.0.1)\n","Requirement already satisfied: scikit-learn>=0.21 in /usr/local/lib/python3.10/dist-packages (from open3d) (1.2.2)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from open3d) (4.66.1)\n","Collecting pyquaternion (from open3d)\n","  Downloading pyquaternion-0.9.9-py3-none-any.whl (14 kB)\n","Requirement already satisfied: fastjsonschema in /usr/local/lib/python3.10/dist-packages (from nbformat==5.7.0->open3d) (2.19.0)\n","Requirement already satisfied: jsonschema>=2.6 in /usr/local/lib/python3.10/dist-packages (from nbformat==5.7.0->open3d) (4.19.2)\n","Requirement already satisfied: jupyter-core in /usr/local/lib/python3.10/dist-packages (from nbformat==5.7.0->open3d) (5.5.0)\n","Requirement already satisfied: traitlets>=5.1 in /usr/local/lib/python3.10/dist-packages (from nbformat==5.7.0->open3d) (5.7.1)\n","Requirement already satisfied: Flask<3.1,>=1.0.4 in /usr/local/lib/python3.10/dist-packages (from dash>=2.6.0->open3d) (2.2.5)\n","Requirement already satisfied: plotly>=5.0.0 in /usr/local/lib/python3.10/dist-packages (from dash>=2.6.0->open3d) (5.15.0)\n","Collecting dash-html-components==2.0.0 (from dash>=2.6.0->open3d)\n","  Downloading dash_html_components-2.0.0-py3-none-any.whl (4.1 kB)\n","Collecting dash-core-components==2.0.0 (from dash>=2.6.0->open3d)\n","  Downloading dash_core_components-2.0.0-py3-none-any.whl (3.8 kB)\n","Collecting dash-table==5.0.0 (from dash>=2.6.0->open3d)\n","  Downloading dash_table-5.0.0-py3-none-any.whl (3.9 kB)\n","Requirement already satisfied: typing-extensions>=4.1.1 in /usr/local/lib/python3.10/dist-packages (from dash>=2.6.0->open3d) (4.5.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from dash>=2.6.0->open3d) (2.31.0)\n","Collecting retrying (from dash>=2.6.0->open3d)\n","  Downloading retrying-1.3.4-py3-none-any.whl (11 kB)\n","Collecting ansi2html (from dash>=2.6.0->open3d)\n","  Downloading ansi2html-1.8.0-py3-none-any.whl (16 kB)\n","Requirement already satisfied: nest-asyncio in /usr/local/lib/python3.10/dist-packages (from dash>=2.6.0->open3d) (1.5.8)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from dash>=2.6.0->open3d) (67.7.2)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.10/dist-packages (from dash>=2.6.0->open3d) (6.8.0)\n","Collecting comm>=0.1.3 (from ipywidgets>=8.0.4->open3d)\n","  Downloading comm-0.2.0-py3-none-any.whl (7.0 kB)\n","Requirement already satisfied: ipython>=6.1.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets>=8.0.4->open3d) (7.34.0)\n","Collecting widgetsnbextension~=4.0.9 (from ipywidgets>=8.0.4->open3d)\n","  Downloading widgetsnbextension-4.0.9-py3-none-any.whl (2.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.3/2.3 MB\u001b[0m \u001b[31m83.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: jupyterlab-widgets~=3.0.9 in /usr/local/lib/python3.10/dist-packages (from ipywidgets>=8.0.4->open3d) (3.0.9)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3->open3d) (1.2.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3->open3d) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3->open3d) (4.45.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3->open3d) (1.4.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3->open3d) (23.2)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3->open3d) (3.1.1)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3->open3d) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.0->open3d) (2023.3.post1)\n","Requirement already satisfied: scipy>=1.3.2 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=0.21->open3d) (1.11.4)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=0.21->open3d) (1.3.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=0.21->open3d) (3.2.0)\n","Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=2.2.3->open3d) (2.1.3)\n","Requirement already satisfied: Jinja2>=3.0 in /usr/local/lib/python3.10/dist-packages (from Flask<3.1,>=1.0.4->dash>=2.6.0->open3d) (3.1.2)\n","Requirement already satisfied: itsdangerous>=2.0 in /usr/local/lib/python3.10/dist-packages (from Flask<3.1,>=1.0.4->dash>=2.6.0->open3d) (2.1.2)\n","Requirement already satisfied: click>=8.0 in /usr/local/lib/python3.10/dist-packages (from Flask<3.1,>=1.0.4->dash>=2.6.0->open3d) (8.1.7)\n","Collecting jedi>=0.16 (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d)\n","  Downloading jedi-0.19.1-py2.py3-none-any.whl (1.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.6/1.6 MB\u001b[0m \u001b[31m84.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (4.4.2)\n","Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (0.7.5)\n","Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (3.0.41)\n","Requirement already satisfied: pygments in /usr/local/lib/python3.10/dist-packages (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (2.16.1)\n","Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (0.2.0)\n","Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (0.1.6)\n","Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/dist-packages (from ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (4.9.0)\n","Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat==5.7.0->open3d) (23.1.0)\n","Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat==5.7.0->open3d) (2023.11.2)\n","Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat==5.7.0->open3d) (0.31.1)\n","Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat==5.7.0->open3d) (0.13.2)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly>=5.0.0->dash>=2.6.0->open3d) (8.2.3)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=3->open3d) (1.16.0)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.10/dist-packages (from importlib-metadata->dash>=2.6.0->open3d) (3.17.0)\n","Requirement already satisfied: platformdirs>=2.5 in /usr/local/lib/python3.10/dist-packages (from jupyter-core->nbformat==5.7.0->open3d) (4.0.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->dash>=2.6.0->open3d) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->dash>=2.6.0->open3d) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->dash>=2.6.0->open3d) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->dash>=2.6.0->open3d) (2023.11.17)\n","Requirement already satisfied: parso<0.9.0,>=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi>=0.16->ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (0.8.3)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect>4.3->ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (0.7.0)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->ipython>=6.1.0->ipywidgets>=8.0.4->open3d) (0.2.12)\n","Installing collected packages: dash-table, dash-html-components, dash-core-components, addict, widgetsnbextension, retrying, pyquaternion, jedi, configargparse, comm, ansi2html, ipywidgets, dash, nbformat, open3d\n","  Attempting uninstall: widgetsnbextension\n","    Found existing installation: widgetsnbextension 3.6.6\n","    Uninstalling widgetsnbextension-3.6.6:\n","      Successfully uninstalled widgetsnbextension-3.6.6\n","  Attempting uninstall: ipywidgets\n","    Found existing installation: ipywidgets 7.7.1\n","    Uninstalling ipywidgets-7.7.1:\n","      Successfully uninstalled ipywidgets-7.7.1\n","  Attempting uninstall: nbformat\n","    Found existing installation: nbformat 5.9.2\n","    Uninstalling nbformat-5.9.2:\n","      Successfully uninstalled nbformat-5.9.2\n","Successfully installed addict-2.4.0 ansi2html-1.8.0 comm-0.2.0 configargparse-1.7 dash-2.14.2 dash-core-components-2.0.0 dash-html-components-2.0.0 dash-table-5.0.0 ipywidgets-8.1.1 jedi-0.19.1 nbformat-5.7.0 open3d-0.17.0 pyquaternion-0.9.9 retrying-1.3.4 widgetsnbextension-4.0.9\n"]}],"source":["%cd /content/drive/My\\ Drive/project/ModelNet40c\n","!pip install -r requirements.txt\n","!pip install open3d\n","#runs and cor_exp, configs\n","#skip apgd\n","# change after -path runs/pgd_..... and -config configs/pgd..."],"id":"PIVJX8-LohA3"},{"cell_type":"markdown","source":["**COR_EXP**"],"metadata":{"id":"heJPyrm18o2d"},"id":"heJPyrm18o2d"},{"cell_type":"markdown","source":["dgcnn_dgcnn_run_1"],"metadata":{"id":"k3OmIKTd9wJg"},"id":"k3OmIKTd9wJg"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path cor_exp/dgcnn_dgcnn_run_ 1/model_best_test.pth --exp-config configs/dgcnn_dgcnn_run_1.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rUSjGTeR9wfB","executionInfo":{"status":"ok","timestamp":1701843798389,"user_tz":480,"elapsed":7355,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"90b4ad49-84fb-4491-c604-d6e760a8e74e"},"id":"rUSjGTeR9wfB","execution_count":7,"outputs":[{"output_type":"stream","name":"stdout","text":["usage: main.py [-h] [--entry ENTRY] [--exp-config EXP_CONFIG] [--model-path MODEL_PATH] [--resume]\n","               [--corruption CORRUPTION] [--output OUTPUT] [--severity SEVERITY] [--confusion]\n","               [--data_dir DATA_DIR] [--norm NORM] [--epsilon EPSILON] [--individual]\n","               [--n_ex N_EX] [--save_dir SAVE_DIR] [--batch_size BATCH_SIZE] [--version VERSION]\n","               [--log_path LOG_PATH]\n","main.py: error: unrecognized arguments: 1/model_best_test.pth\n"]}]},{"cell_type":"markdown","source":["dgcnn_pct_run_1"],"metadata":{"id":"4JfzZ-9C8t2H"},"id":"4JfzZ-9C8t2H"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path cor_exp/dgcnn_pct_run_1/model_best_test.pth --exp-config configs/dgcnn_pct_run_1.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"z866iIIH8xLF","executionInfo":{"status":"ok","timestamp":1701767988626,"user_tz":480,"elapsed":16347,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"2661a319-3d5e-465a-acbe-57760e6cd61a"},"id":"z866iIIH8xLF","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: none\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: dgcnn_pct_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pct\n","  OPTIMIZER: pct\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.0001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Pct(\n","  (model): Pct(\n","    (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (conv2): Conv1d(64, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (gather_local_0): Local_op(\n","      (conv1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (gather_local_1): Local_op(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (pt_last): Point_Transformer_Last(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (sa1): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa2): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa3): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa4): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","    )\n","    (conv_fuse): Sequential(\n","      (0): Conv1d(1280, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=1024, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from cor_exp/dgcnn_pct_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py:52: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)\n","  output = torch.cuda.IntTensor(B, npoint)\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pct.py\", line 29, in forward\n","    logit = self.model(pc)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/model.py\", line 59, in forward\n","    new_xyz, new_feature = sample_and_group(npoint=512, radius=0.15, nsample=32, xyz=xyz, points=x)         \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/util.py\", line 127, in sample_and_group\n","    fps_idx = pointnet2_utils.furthest_point_sample(xyz, npoint).long() # [B, npoint]\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py\", line 54, in forward\n","    pointnet2.furthest_point_sampling_wrapper(\n","AttributeError: module '_ext.pointnet2' has no attribute 'furthest_point_sampling_wrapper'\n"]}]},{"cell_type":"markdown","source":["dgcnn_pointnet2_run_1"],"metadata":{"id":"-0zbkaZ5-vj_"},"id":"-0zbkaZ5-vj_"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path cor_exp/dgcnn_pointnet2_run_1/model_best_test.pth --exp-config configs/dgcnn_pointnet2_run_1.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"j9wmftMf-wIw","executionInfo":{"status":"ok","timestamp":1701767996705,"user_tz":480,"elapsed":8088,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"2c459cbc-b311-4d0b-8afc-1aedfd6f4d9e"},"id":"j9wmftMf-wIw","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: none\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: dgcnn_pointnet2_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet2\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 421, in get_model\n","    model = models.PointNet2(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pointnet2.py\", line 20, in __init__\n","    self.model = Pointnet2MSG(num_classes=num_class, input_channels=0, use_xyz=True, version=version_cls)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/pointnet2_pyt/pointnet2/models/pointnet2_msg_cls.py\", line 59, in __init__\n","    PointnetSAModuleMSG(\n","NameError: name 'PointnetSAModuleMSG' is not defined. Did you mean: 'PointnetSAModule'?\n"]}]},{"cell_type":"markdown","source":["dgcnn_pointnet_run_1"],"metadata":{"id":"g-3ofjjO_Ims"},"id":"g-3ofjjO_Ims"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path cor_exp/dgcnn_pointnet_run_1/model_best_test.pth --exp-config configs/dgcnn_pointnet_run_1.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_Zp_8SWz_IK2","executionInfo":{"status":"ok","timestamp":1701768082006,"user_tz":480,"elapsed":85310,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"cb3e935f-f16a-4816-9e54-a3931e2bb99e"},"id":"_Zp_8SWz_IK2","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: none\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: dgcnn_pointnet_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls_trans\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","PointNet(\n","  (model): PointNetCls(\n","    (feat): PointNetfeat(\n","      (stn): STN3d(\n","        (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=9, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","      (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","      (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","      (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","      (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (fstn): STNkd(\n","        (conv1): Conv1d(64, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=4096, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","    )\n","    (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","    (fc2): Linear(in_features=512, out_features=256, bias=True)\n","    (fc3): Linear(in_features=256, out_features=40, bias=True)\n","    (dropout): Dropout(p=0.3, inplace=False)\n","    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (relu): ReLU()\n","  )\n",")\n","Recovering model and checkpoint from cor_exp/dgcnn_pointnet_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 90.04%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 2/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 3/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 4/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 5/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 6/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 7/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 8/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 9/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 10/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 11/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 12/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 13/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 14/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 15/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 16/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 17/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 18/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 19/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 20/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 22/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 23/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 24/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 25/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 26/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 27/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 28/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 29/29 - 26 out of 26 successfully perturbed\n","robust accuracy after APGD-CE: 1.86% (total time 62.6 s)\n","apgd-t - 1/1 - 19 out of 19 successfully perturbed\n","robust accuracy after APGD-T: 0.00% (total time 71.5 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.00%\n"]}]},{"cell_type":"markdown","source":["dgcnn_rscnn_run_1"],"metadata":{"id":"cNZBsljQ_LYz"},"id":"cNZBsljQ_LYz"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path cor_exp/dgcnn_rscnn_run_1/model_best_test.pth --exp-config configs/dgcnn_rscnn_run_1.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yzicK7wK_Lop","executionInfo":{"status":"ok","timestamp":1701768095229,"user_tz":480,"elapsed":13232,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"2bd8c1fb-3447-4fb0-82d2-466851cf61aa"},"id":"yzicK7wK_Lop","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: none\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: dgcnn_rscnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: rscnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","RSCNN(\n","  (model): RSCNN_SSN(\n","    (SA_modules): ModuleList(\n","      (0): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 64, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(16, 128, kernel_size=(1,), stride=(1,))\n","                (xyz_raising): Conv2d(3, 16, kernel_size=(1, 1), stride=(1, 1))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (1): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(131, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 128, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(128, 131, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(131, 512, kernel_size=(1,), stride=(1,))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (2): PointnetSAModule(\n","        (groupers): ModuleList(\n","          (0): GroupAll()\n","        )\n","        (mlps): ModuleList(\n","          (0): GloAvgConv(\n","            (conv_avg): Conv2d(515, 1024, kernel_size=(1, 1), stride=(1, 1))\n","            (bn_avg): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","            (activation): ReLU(inplace=True)\n","          )\n","        )\n","      )\n","    )\n","    (FC_layer): Sequential(\n","      (0): FC(\n","        (fc): Linear(in_features=1024, out_features=512, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (1): Dropout(p=0.5, inplace=False)\n","      (2): FC(\n","        (fc): Linear(in_features=512, out_features=256, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (3): Dropout(p=0.5, inplace=False)\n","      (4): FC(\n","        (fc): Linear(in_features=256, out_features=40, bias=True)\n","      )\n","    )\n","  )\n",")\n","Recovering model and checkpoint from cor_exp/dgcnn_rscnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/rscnn.py\", line 39, in forward\n","    out = {'logit': self.model(pc)}\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/rscnn_ssn_cls.py\", line 96, in forward\n","    xyz, features = module(xyz, features)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_modules_updated.py\", line 146, in forward\n","    fps_idx = tp.furthest_point_sample(xyz, self.npoint)  # (B, npoint)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/pointnet2_ops_lib/pointnet2_ops/pointnet2_utils.py\", line 55, in forward\n","    out = _ext.furthest_point_sampling(xyz, npoint)\n","NameError: name '_ext' is not defined. Did you mean: 'Text'?\n"]}]},{"cell_type":"markdown","source":["dgcnn_simpleview_run_1"],"metadata":{"id":"4O2j-gRL_N6c"},"id":"4O2j-gRL_N6c"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path cor_exp/dgcnn_simpleview_run_1/model_best_test.pth --exp-config configs/dgcnn_simpleview_run_1.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NHxX3Ged_OLZ","executionInfo":{"status":"ok","timestamp":1701768106689,"user_tz":480,"elapsed":11478,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"42b04843-0cdc-437d-b3d7-570073ae02cf"},"id":"NHxX3Ged_OLZ","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: none\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 18\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: dgcnn_simpleview_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: simpleview\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 411, in get_model\n","    model = models.MVModel(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 23, in __init__\n","    img_layers, in_features = self.get_img_layers(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 63, in get_img_layers\n","    from models.resnet import _resnet, BasicBlock\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/resnet.py\", line 3, in <module>\n","    from torchvision.models.utils import load_state_dict_from_url\n","ModuleNotFoundError: No module named 'torchvision.models.utils'\n"]}]},{"cell_type":"markdown","source":["**RUNS**"],"metadata":{"id":"vjjRVAyP_R5N"},"id":"vjjRVAyP_R5N"},{"cell_type":"markdown","source":["cutmix_k_dgcnn_run_1"],"metadata":{"id":"hOLwHrM5BgP_"},"id":"hOLwHrM5BgP_"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_k_dgcnn_run_1/model_best_test.pth --exp-config configs/cutmix/dgcnn_k.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"X_d7QCY0BghZ","executionInfo":{"status":"ok","timestamp":1701768444907,"user_tz":480,"elapsed":338231,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"d1e91237-bb29-4df6-c3f8-1d772d61953c"},"id":"X_d7QCY0BghZ","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_k\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_k_dgcnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: dgcnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","DGCNN(\n","  (model): DGCNN(\n","    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn5): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (conv1): Sequential(\n","      (0): Conv2d(6, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv2): Sequential(\n","      (0): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv3): Sequential(\n","      (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv4): Sequential(\n","      (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv5): Sequential(\n","      (0): Conv1d(512, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=2048, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_k_dgcnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 92.19%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 2/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 3/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 4/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 5/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 6/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 7/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 8/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 9/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 10/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 11/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 12/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 13/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 14/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 15/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 16/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 17/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 18/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 19/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 20/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 22/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 23/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 24/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 25/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 26/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 27/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 28/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 29/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 30/30 - 16 out of 16 successfully perturbed\n","robust accuracy after APGD-CE: 0.10% (total time 321.0 s)\n","apgd-t - 1/1 - 1 out of 1 successfully perturbed\n","robust accuracy after APGD-T: 0.00% (total time 322.5 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.00%\n"]}]},{"cell_type":"markdown","source":["cutmix_k_pct_run_1"],"metadata":{"id":"blUCuuIaCS18"},"id":"blUCuuIaCS18"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_k_pct_run_1/model_best_test.pth --exp-config configs/cutmix/pct_k.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"P2Mmd648CTGI","executionInfo":{"status":"ok","timestamp":1701768457790,"user_tz":480,"elapsed":12885,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"22edd317-8a44-491b-e3b7-6207ade2f588"},"id":"P2Mmd648CTGI","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_k\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_k_pct_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pct\n","  OPTIMIZER: pct\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.0001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Pct(\n","  (model): Pct(\n","    (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (conv2): Conv1d(64, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (gather_local_0): Local_op(\n","      (conv1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (gather_local_1): Local_op(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (pt_last): Point_Transformer_Last(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (sa1): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa2): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa3): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa4): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","    )\n","    (conv_fuse): Sequential(\n","      (0): Conv1d(1280, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=1024, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_k_pct_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py:52: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)\n","  output = torch.cuda.IntTensor(B, npoint)\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pct.py\", line 29, in forward\n","    logit = self.model(pc)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/model.py\", line 59, in forward\n","    new_xyz, new_feature = sample_and_group(npoint=512, radius=0.15, nsample=32, xyz=xyz, points=x)         \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/util.py\", line 127, in sample_and_group\n","    fps_idx = pointnet2_utils.furthest_point_sample(xyz, npoint).long() # [B, npoint]\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py\", line 54, in forward\n","    pointnet2.furthest_point_sampling_wrapper(\n","AttributeError: module '_ext.pointnet2' has no attribute 'furthest_point_sampling_wrapper'\n"]}]},{"cell_type":"markdown","source":["cutmix_k_pointnet2_run_1"],"metadata":{"id":"blW23xU6CquE"},"id":"blW23xU6CquE"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_k_pointnet2_run_1/model_best_test.pth --exp-config configs/cutmix/pointnet2_k.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cekDTQ6vCrDA","executionInfo":{"status":"ok","timestamp":1701768465252,"user_tz":480,"elapsed":7477,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"12fdd86e-c51b-42fa-dbdd-661bbb9aaa8c"},"id":"cekDTQ6vCrDA","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_k\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_k_pointnet2_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet2\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 421, in get_model\n","    model = models.PointNet2(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pointnet2.py\", line 20, in __init__\n","    self.model = Pointnet2MSG(num_classes=num_class, input_channels=0, use_xyz=True, version=version_cls)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/pointnet2_pyt/pointnet2/models/pointnet2_msg_cls.py\", line 59, in __init__\n","    PointnetSAModuleMSG(\n","NameError: name 'PointnetSAModuleMSG' is not defined. Did you mean: 'PointnetSAModule'?\n"]}]},{"cell_type":"markdown","source":["cutmix_k_pointnet_run_1"],"metadata":{"id":"yGn2MPezDOMI"},"id":"yGn2MPezDOMI"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_k_pointnet_run_1/model_best_test.pth --exp-config configs/cutmix/pointnet_k.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3Yl4UfV89bkc","executionInfo":{"status":"ok","timestamp":1701768554557,"user_tz":480,"elapsed":89306,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"376a9cdb-6eed-4c3b-9b52-1d90508597b0"},"id":"3Yl4UfV89bkc","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_k\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_k_pointnet_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls_trans\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","PointNet(\n","  (model): PointNetCls(\n","    (feat): PointNetfeat(\n","      (stn): STN3d(\n","        (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=9, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","      (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","      (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","      (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","      (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (fstn): STNkd(\n","        (conv1): Conv1d(64, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=4096, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","    )\n","    (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","    (fc2): Linear(in_features=512, out_features=256, bias=True)\n","    (fc3): Linear(in_features=256, out_features=40, bias=True)\n","    (dropout): Dropout(p=0.3, inplace=False)\n","    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (relu): ReLU()\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_k_pointnet_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 91.21%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/30 - 30 out of 32 successfully perturbed\n","apgd-ce - 2/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 3/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 4/30 - 30 out of 32 successfully perturbed\n","apgd-ce - 5/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 6/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 7/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 8/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 9/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 10/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 11/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 12/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 13/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 14/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 15/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 16/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 17/30 - 30 out of 32 successfully perturbed\n","apgd-ce - 18/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 19/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 20/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 22/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 23/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 24/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 25/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 26/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 27/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 28/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 29/30 - 30 out of 32 successfully perturbed\n","apgd-ce - 30/30 - 6 out of 6 successfully perturbed\n","robust accuracy after APGD-CE: 1.95% (total time 63.7 s)\n","apgd-t - 1/1 - 17 out of 20 successfully perturbed\n","robust accuracy after APGD-T: 0.29% (total time 76.0 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.29%\n"]}]},{"cell_type":"markdown","source":["cutmix_k_rscnn_run_1"],"metadata":{"id":"a1SIFAsbDUGX"},"id":"a1SIFAsbDUGX"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_k_rscnn_run_1/model_best_test.pth --exp-config configs/cutmix/rscnn_k.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"AKsjS3eaDTxz","executionInfo":{"status":"ok","timestamp":1701768565850,"user_tz":480,"elapsed":11302,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"2f54c97e-2b25-43db-ef0c-424e8c2bda9f"},"id":"AKsjS3eaDTxz","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_k\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_k_rscnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: rscnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","RSCNN(\n","  (model): RSCNN_SSN(\n","    (SA_modules): ModuleList(\n","      (0): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 64, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(16, 128, kernel_size=(1,), stride=(1,))\n","                (xyz_raising): Conv2d(3, 16, kernel_size=(1, 1), stride=(1, 1))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (1): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(131, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 128, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(128, 131, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(131, 512, kernel_size=(1,), stride=(1,))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (2): PointnetSAModule(\n","        (groupers): ModuleList(\n","          (0): GroupAll()\n","        )\n","        (mlps): ModuleList(\n","          (0): GloAvgConv(\n","            (conv_avg): Conv2d(515, 1024, kernel_size=(1, 1), stride=(1, 1))\n","            (bn_avg): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","            (activation): ReLU(inplace=True)\n","          )\n","        )\n","      )\n","    )\n","    (FC_layer): Sequential(\n","      (0): FC(\n","        (fc): Linear(in_features=1024, out_features=512, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (1): Dropout(p=0.5, inplace=False)\n","      (2): FC(\n","        (fc): Linear(in_features=512, out_features=256, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (3): Dropout(p=0.5, inplace=False)\n","      (4): FC(\n","        (fc): Linear(in_features=256, out_features=40, bias=True)\n","      )\n","    )\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_k_rscnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/rscnn.py\", line 39, in forward\n","    out = {'logit': self.model(pc)}\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/rscnn_ssn_cls.py\", line 96, in forward\n","    xyz, features = module(xyz, features)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_modules_updated.py\", line 146, in forward\n","    fps_idx = tp.furthest_point_sample(xyz, self.npoint)  # (B, npoint)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/pointnet2_ops_lib/pointnet2_ops/pointnet2_utils.py\", line 55, in forward\n","    out = _ext.furthest_point_sampling(xyz, npoint)\n","NameError: name '_ext' is not defined. Did you mean: 'Text'?\n"]}]},{"cell_type":"markdown","source":["cutmix_k_simpleview_run_1"],"metadata":{"id":"RO_FDGHeD1rQ"},"id":"RO_FDGHeD1rQ"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_k_simpleview_run_1/model_best_test.pth --exp-config configs/cutmix/simpleview_k.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4X9TLPrhD2Bd","executionInfo":{"status":"ok","timestamp":1701768575746,"user_tz":480,"elapsed":9904,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"b5859025-035d-4bbf-b05f-612ca45c11c9"},"id":"4X9TLPrhD2Bd","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_k\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 18\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_k_simpleview_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: simpleview\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 411, in get_model\n","    model = models.MVModel(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 23, in __init__\n","    img_layers, in_features = self.get_img_layers(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 63, in get_img_layers\n","    from models.resnet import _resnet, BasicBlock\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/resnet.py\", line 3, in <module>\n","    from torchvision.models.utils import load_state_dict_from_url\n","ModuleNotFoundError: No module named 'torchvision.models.utils'\n"]}]},{"cell_type":"markdown","source":["cutmix_r_dgcnn_run_1"],"metadata":{"id":"R2iSmoxU2LwY"},"id":"R2iSmoxU2LwY"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_r_dgcnn_run_1/model_best_test.pth --exp-config configs/cutmix/dgcnn_r.yaml --epsilon=0.05"],"metadata":{"id":"LrPtpfkq2K-Z","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701768914698,"user_tz":480,"elapsed":338968,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"74d37a68-6a74-4095-fbf0-db123fafa72f"},"id":"LrPtpfkq2K-Z","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_r\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_r_dgcnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: dgcnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","DGCNN(\n","  (model): DGCNN(\n","    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn5): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (conv1): Sequential(\n","      (0): Conv2d(6, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv2): Sequential(\n","      (0): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv3): Sequential(\n","      (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv4): Sequential(\n","      (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv5): Sequential(\n","      (0): Conv1d(512, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=2048, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_r_dgcnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 92.38%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 2/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 3/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 4/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 5/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 6/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 7/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 8/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 9/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 10/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 11/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 12/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 13/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 14/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 15/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 16/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 17/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 18/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 19/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 20/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 22/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 23/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 24/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 25/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 26/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 27/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 28/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 29/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 30/30 - 18 out of 18 successfully perturbed\n","robust accuracy after APGD-CE: 0.49% (total time 320.9 s)\n","apgd-t - 1/1 - 5 out of 5 successfully perturbed\n","robust accuracy after APGD-T: 0.00% (total time 323.7 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.00%\n"]}]},{"cell_type":"markdown","source":["cutmix_r_pct_run_1"],"metadata":{"id":"Lz8C110hFvt4"},"id":"Lz8C110hFvt4"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_r_pct_run_1/model_best_test.pth --exp-config configs/cutmix/pct_r.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8_xopRy7FwF8","executionInfo":{"status":"ok","timestamp":1701768928096,"user_tz":480,"elapsed":13407,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"130bea17-b023-485a-cffa-11106f3efe4d"},"id":"8_xopRy7FwF8","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_r\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_r_pct_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pct\n","  OPTIMIZER: pct\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.0001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Pct(\n","  (model): Pct(\n","    (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (conv2): Conv1d(64, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (gather_local_0): Local_op(\n","      (conv1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (gather_local_1): Local_op(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (pt_last): Point_Transformer_Last(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (sa1): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa2): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa3): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa4): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","    )\n","    (conv_fuse): Sequential(\n","      (0): Conv1d(1280, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=1024, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_r_pct_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py:52: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)\n","  output = torch.cuda.IntTensor(B, npoint)\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pct.py\", line 29, in forward\n","    logit = self.model(pc)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/model.py\", line 59, in forward\n","    new_xyz, new_feature = sample_and_group(npoint=512, radius=0.15, nsample=32, xyz=xyz, points=x)         \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/util.py\", line 127, in sample_and_group\n","    fps_idx = pointnet2_utils.furthest_point_sample(xyz, npoint).long() # [B, npoint]\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py\", line 54, in forward\n","    pointnet2.furthest_point_sampling_wrapper(\n","AttributeError: module '_ext.pointnet2' has no attribute 'furthest_point_sampling_wrapper'\n"]}]},{"cell_type":"markdown","source":["cutmix_r_pointnet2_run_1"],"metadata":{"id":"w9LA0TL8G4Ev"},"id":"w9LA0TL8G4Ev"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_r_pointnet2_run_1/model_best_test.pth --exp-config configs/cutmix/pointnet2_r.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RYbMIDqKG4cb","executionInfo":{"status":"ok","timestamp":1701768935759,"user_tz":480,"elapsed":7665,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"01da2c6d-770b-495c-86c0-554876aa4854"},"id":"RYbMIDqKG4cb","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_r\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_r_pointnet2_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet2\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 421, in get_model\n","    model = models.PointNet2(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pointnet2.py\", line 20, in __init__\n","    self.model = Pointnet2MSG(num_classes=num_class, input_channels=0, use_xyz=True, version=version_cls)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/pointnet2_pyt/pointnet2/models/pointnet2_msg_cls.py\", line 59, in __init__\n","    PointnetSAModuleMSG(\n","NameError: name 'PointnetSAModuleMSG' is not defined. Did you mean: 'PointnetSAModule'?\n"]}]},{"cell_type":"markdown","source":["cutmix_r_pointnet_run_1"],"metadata":{"id":"vVe3zvDmHNUX"},"id":"vVe3zvDmHNUX"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_r_pointnet_run_1/model_best_test.pth --exp-config configs/cutmix/pointnet_r.yaml"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"iH7ag8LuHNnr","executionInfo":{"status":"ok","timestamp":1701769044038,"user_tz":480,"elapsed":108281,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"c3a8b7ff-c3a9-4d4e-c0e0-bf6b0a77c4c4"},"id":"iH7ag8LuHNnr","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_r\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_r_pointnet_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls_trans\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","PointNet(\n","  (model): PointNetCls(\n","    (feat): PointNetfeat(\n","      (stn): STN3d(\n","        (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=9, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","      (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","      (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","      (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","      (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (fstn): STNkd(\n","        (conv1): Conv1d(64, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=4096, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","    )\n","    (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","    (fc2): Linear(in_features=512, out_features=256, bias=True)\n","    (fc3): Linear(in_features=256, out_features=40, bias=True)\n","    (dropout): Dropout(p=0.3, inplace=False)\n","    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (relu): ReLU()\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_r_pointnet_run_1/model_best_test.pth\n","EPSILON\n","0.03137254901960784\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 90.33%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/29 - 28 out of 32 successfully perturbed\n","apgd-ce - 2/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 3/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 4/29 - 27 out of 32 successfully perturbed\n","apgd-ce - 5/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 6/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 7/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 8/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 9/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 10/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 11/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 12/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 13/29 - 28 out of 32 successfully perturbed\n","apgd-ce - 14/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 15/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 16/29 - 28 out of 32 successfully perturbed\n","apgd-ce - 17/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 18/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 19/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 20/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 22/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 23/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 24/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 25/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 26/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 27/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 28/29 - 25 out of 32 successfully perturbed\n","apgd-ce - 29/29 - 28 out of 29 successfully perturbed\n","robust accuracy after APGD-CE: 6.05% (total time 62.5 s)\n","apgd-t - 1/2 - 18 out of 32 successfully perturbed\n","apgd-t - 2/2 - 17 out of 30 successfully perturbed\n","robust accuracy after APGD-T: 2.64% (total time 94.6 s)\n","max Linf perturbation: 0.03137, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 2.64%\n"]}]},{"cell_type":"markdown","source":["cutmix_r_rscnn_run_1"],"metadata":{"id":"meQcbPqFHdjN"},"id":"meQcbPqFHdjN"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_r_rscnn_run_1/model_best_test.pth --exp-config configs/cutmix/rscnn_r.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8nITHcG_HdzI","executionInfo":{"status":"ok","timestamp":1701769055223,"user_tz":480,"elapsed":11189,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"09d39ff9-a88a-48be-fe20-b950a179f410"},"id":"8nITHcG_HdzI","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_r\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_r_rscnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: rscnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","RSCNN(\n","  (model): RSCNN_SSN(\n","    (SA_modules): ModuleList(\n","      (0): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 64, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(16, 128, kernel_size=(1,), stride=(1,))\n","                (xyz_raising): Conv2d(3, 16, kernel_size=(1, 1), stride=(1, 1))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (1): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(131, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 128, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(128, 131, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(131, 512, kernel_size=(1,), stride=(1,))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (2): PointnetSAModule(\n","        (groupers): ModuleList(\n","          (0): GroupAll()\n","        )\n","        (mlps): ModuleList(\n","          (0): GloAvgConv(\n","            (conv_avg): Conv2d(515, 1024, kernel_size=(1, 1), stride=(1, 1))\n","            (bn_avg): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","            (activation): ReLU(inplace=True)\n","          )\n","        )\n","      )\n","    )\n","    (FC_layer): Sequential(\n","      (0): FC(\n","        (fc): Linear(in_features=1024, out_features=512, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (1): Dropout(p=0.5, inplace=False)\n","      (2): FC(\n","        (fc): Linear(in_features=512, out_features=256, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (3): Dropout(p=0.5, inplace=False)\n","      (4): FC(\n","        (fc): Linear(in_features=256, out_features=40, bias=True)\n","      )\n","    )\n","  )\n",")\n","Recovering model and checkpoint from runs/cutmix_r_rscnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/rscnn.py\", line 39, in forward\n","    out = {'logit': self.model(pc)}\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/rscnn_ssn_cls.py\", line 96, in forward\n","    xyz, features = module(xyz, features)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_modules_updated.py\", line 146, in forward\n","    fps_idx = tp.furthest_point_sample(xyz, self.npoint)  # (B, npoint)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/pointnet2_ops_lib/pointnet2_ops/pointnet2_utils.py\", line 55, in forward\n","    out = _ext.furthest_point_sampling(xyz, npoint)\n","NameError: name '_ext' is not defined. Did you mean: 'Text'?\n"]}]},{"cell_type":"markdown","source":["cutmix_r_simpleview_run_1"],"metadata":{"id":"ak8uEhZ_HqvG"},"id":"ak8uEhZ_HqvG"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/cutmix_r_simpleview_run_1/model_best_test.pth --exp-config configs/cutmix/simpleview_r.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YfJTSSNwHrDS","executionInfo":{"status":"ok","timestamp":1701769065154,"user_tz":480,"elapsed":9939,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"262a53b2-d50c-455e-ec77-7d1f42ae8a82"},"id":"YfJTSSNwHrDS","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: cutmix_r\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 18\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: cutmix_r_simpleview_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: simpleview\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 411, in get_model\n","    model = models.MVModel(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 23, in __init__\n","    img_layers, in_features = self.get_img_layers(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 63, in get_img_layers\n","    from models.resnet import _resnet, BasicBlock\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/resnet.py\", line 3, in <module>\n","    from torchvision.models.utils import load_state_dict_from_url\n","ModuleNotFoundError: No module named 'torchvision.models.utils'\n"]}]},{"cell_type":"markdown","source":["mixup_dgcnn_run_1"],"metadata":{"id":"u-tHoUXoIIOO"},"id":"u-tHoUXoIIOO"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/mixup_dgcnn_run_1/model_best_test.pth --exp-config configs/mixup/dgcnn.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hAKSEMAdIInJ","executionInfo":{"status":"ok","timestamp":1701769405266,"user_tz":480,"elapsed":340121,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"2b9a5188-5d23-4ec3-9165-5b3268b8cf68"},"id":"hAKSEMAdIInJ","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: mixup\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: mixup_dgcnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: dgcnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","DGCNN(\n","  (model): DGCNN(\n","    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn5): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (conv1): Sequential(\n","      (0): Conv2d(6, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv2): Sequential(\n","      (0): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv3): Sequential(\n","      (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv4): Sequential(\n","      (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv5): Sequential(\n","      (0): Conv1d(512, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=2048, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/mixup_dgcnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 92.38%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 2/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 3/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 4/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 5/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 6/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 7/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 8/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 9/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 10/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 11/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 12/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 13/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 14/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 15/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 16/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 17/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 18/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 19/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 20/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 22/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 23/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 24/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 25/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 26/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 27/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 28/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 29/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 30/30 - 18 out of 18 successfully perturbed\n","robust accuracy after APGD-CE: 0.10% (total time 321.1 s)\n","apgd-t - 1/1 - 1 out of 1 successfully perturbed\n","robust accuracy after APGD-T: 0.00% (total time 324.2 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.00%\n"]}]},{"cell_type":"markdown","source":["mixup_pct_run_1"],"metadata":{"id":"dAYSc5WtIc82"},"id":"dAYSc5WtIc82"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/mixup_pct_run_1/model_best_test.pth --exp-config configs/mixup/pct.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Wx9YNtuaId7k","executionInfo":{"status":"ok","timestamp":1701769418630,"user_tz":480,"elapsed":13365,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"892baf2f-8d5b-4ca6-fe14-b2c1060933c9"},"id":"Wx9YNtuaId7k","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: mixup\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: mixup_pct_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pct\n","  OPTIMIZER: pct\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.0001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Pct(\n","  (model): Pct(\n","    (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (conv2): Conv1d(64, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (gather_local_0): Local_op(\n","      (conv1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (gather_local_1): Local_op(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (pt_last): Point_Transformer_Last(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (sa1): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa2): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa3): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa4): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","    )\n","    (conv_fuse): Sequential(\n","      (0): Conv1d(1280, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=1024, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/mixup_pct_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py:52: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)\n","  output = torch.cuda.IntTensor(B, npoint)\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pct.py\", line 29, in forward\n","    logit = self.model(pc)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/model.py\", line 59, in forward\n","    new_xyz, new_feature = sample_and_group(npoint=512, radius=0.15, nsample=32, xyz=xyz, points=x)         \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/util.py\", line 127, in sample_and_group\n","    fps_idx = pointnet2_utils.furthest_point_sample(xyz, npoint).long() # [B, npoint]\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py\", line 54, in forward\n","    pointnet2.furthest_point_sampling_wrapper(\n","AttributeError: module '_ext.pointnet2' has no attribute 'furthest_point_sampling_wrapper'\n"]}]},{"cell_type":"markdown","source":["mixup_pointnet2_run_1"],"metadata":{"id":"uG4lt80UIx6J"},"id":"uG4lt80UIx6J"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/mixup_pointnet2_run_1/model_best_test.pth --exp-config configs/mixup/pointnet2.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DnF1lng-IyRA","executionInfo":{"status":"ok","timestamp":1701769426121,"user_tz":480,"elapsed":7508,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"e7a73b67-7cd0-442d-e9be-56ee6054fc9f"},"id":"DnF1lng-IyRA","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: mixup\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: mixup_pointnet2_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet2\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 421, in get_model\n","    model = models.PointNet2(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pointnet2.py\", line 20, in __init__\n","    self.model = Pointnet2MSG(num_classes=num_class, input_channels=0, use_xyz=True, version=version_cls)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/pointnet2_pyt/pointnet2/models/pointnet2_msg_cls.py\", line 59, in __init__\n","    PointnetSAModuleMSG(\n","NameError: name 'PointnetSAModuleMSG' is not defined. Did you mean: 'PointnetSAModule'?\n"]}]},{"cell_type":"markdown","source":["mixup_pointnet_run_1"],"metadata":{"id":"SnafjZt9JArg"},"id":"SnafjZt9JArg"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/mixup_pointnet_run_1/model_best_test.pth --exp-config configs/mixup/pointnet.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xRibdtQyJBG_","executionInfo":{"status":"ok","timestamp":1701769508262,"user_tz":480,"elapsed":82150,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"a4aeffb1-496f-4157-deef-243ad85da6cd"},"id":"xRibdtQyJBG_","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: mixup\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: mixup_pointnet_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls_trans\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","PointNet(\n","  (model): PointNetCls(\n","    (feat): PointNetfeat(\n","      (stn): STN3d(\n","        (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=9, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","      (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","      (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","      (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","      (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (fstn): STNkd(\n","        (conv1): Conv1d(64, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=4096, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","    )\n","    (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","    (fc2): Linear(in_features=512, out_features=256, bias=True)\n","    (fc3): Linear(in_features=256, out_features=40, bias=True)\n","    (dropout): Dropout(p=0.3, inplace=False)\n","    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (relu): ReLU()\n","  )\n",")\n","Recovering model and checkpoint from runs/mixup_pointnet_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 90.92%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 2/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 3/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 4/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 5/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 6/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 7/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 8/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 9/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 10/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 11/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 12/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 13/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 14/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 15/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 16/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 17/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 18/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 19/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 20/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 22/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 23/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 24/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 25/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 26/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 27/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 28/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 29/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 30/30 - 3 out of 3 successfully perturbed\n","robust accuracy after APGD-CE: 0.29% (total time 63.7 s)\n","apgd-t - 1/1 - 3 out of 3 successfully perturbed\n","robust accuracy after APGD-T: 0.00% (total time 67.7 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.00%\n"]}]},{"cell_type":"markdown","source":["mixup_rscnn_run_1"],"metadata":{"id":"gdCkvLgUJShx"},"id":"gdCkvLgUJShx"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/mixup_rscnn_run_1/model_best_test.pth --exp-config configs/mixup/rscnn.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hb6yLqjHJTBU","executionInfo":{"status":"ok","timestamp":1701769519137,"user_tz":480,"elapsed":10894,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"005f62c6-23bb-4240-c9e4-df31f4f09a8c"},"id":"hb6yLqjHJTBU","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: mixup\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: mixup_rscnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: rscnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","RSCNN(\n","  (model): RSCNN_SSN(\n","    (SA_modules): ModuleList(\n","      (0): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 64, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(16, 128, kernel_size=(1,), stride=(1,))\n","                (xyz_raising): Conv2d(3, 16, kernel_size=(1, 1), stride=(1, 1))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (1): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(131, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 128, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(128, 131, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(131, 512, kernel_size=(1,), stride=(1,))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (2): PointnetSAModule(\n","        (groupers): ModuleList(\n","          (0): GroupAll()\n","        )\n","        (mlps): ModuleList(\n","          (0): GloAvgConv(\n","            (conv_avg): Conv2d(515, 1024, kernel_size=(1, 1), stride=(1, 1))\n","            (bn_avg): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","            (activation): ReLU(inplace=True)\n","          )\n","        )\n","      )\n","    )\n","    (FC_layer): Sequential(\n","      (0): FC(\n","        (fc): Linear(in_features=1024, out_features=512, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (1): Dropout(p=0.5, inplace=False)\n","      (2): FC(\n","        (fc): Linear(in_features=512, out_features=256, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (3): Dropout(p=0.5, inplace=False)\n","      (4): FC(\n","        (fc): Linear(in_features=256, out_features=40, bias=True)\n","      )\n","    )\n","  )\n",")\n","Recovering model and checkpoint from runs/mixup_rscnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/rscnn.py\", line 39, in forward\n","    out = {'logit': self.model(pc)}\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/rscnn_ssn_cls.py\", line 96, in forward\n","    xyz, features = module(xyz, features)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_modules_updated.py\", line 146, in forward\n","    fps_idx = tp.furthest_point_sample(xyz, self.npoint)  # (B, npoint)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/pointnet2_ops_lib/pointnet2_ops/pointnet2_utils.py\", line 55, in forward\n","    out = _ext.furthest_point_sampling(xyz, npoint)\n","NameError: name '_ext' is not defined. Did you mean: 'Text'?\n"]}]},{"cell_type":"markdown","source":["mixup_simpleview_run_1"],"metadata":{"id":"-g6i323pJm0c"},"id":"-g6i323pJm0c"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/mixup_simpleview_run_1/model_best_test.pth --exp-config configs/mixup/simpleview.yaml --epsilon=0.05"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PCmo_2QFJnGQ","executionInfo":{"status":"ok","timestamp":1701769529029,"user_tz":480,"elapsed":9911,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"427d7713-cc50-492f-a9f7-0dd645f4fefd"},"id":"PCmo_2QFJnGQ","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: mixup\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: mixup_simpleview_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: simpleview\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 411, in get_model\n","    model = models.MVModel(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 23, in __init__\n","    img_layers, in_features = self.get_img_layers(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 63, in get_img_layers\n","    from models.resnet import _resnet, BasicBlock\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/resnet.py\", line 3, in <module>\n","    from torchvision.models.utils import load_state_dict_from_url\n","ModuleNotFoundError: No module named 'torchvision.models.utils'\n"]}]},{"cell_type":"markdown","source":["pgd_dgcnn_run_1"],"metadata":{"id":"q711FjF9GvxV"},"id":"q711FjF9GvxV"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"R4wk1iPrdNjk","outputId":"658f87fd-bb17-4ef1-eb03-68e3984b1b93","executionInfo":{"status":"ok","timestamp":1701771626126,"user_tz":480,"elapsed":347937,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: pgd\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: pgd_dgcnn_run2_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: dgcnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","DGCNN(\n","  (model): DGCNN(\n","    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn5): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (conv1): Sequential(\n","      (0): Conv2d(6, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv2): Sequential(\n","      (0): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv3): Sequential(\n","      (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv4): Sequential(\n","      (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv5): Sequential(\n","      (0): Conv1d(512, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=2048, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/pgd_dgcnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 92.19%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/30 - 6 out of 32 successfully perturbed\n","apgd-ce - 2/30 - 9 out of 32 successfully perturbed\n","apgd-ce - 3/30 - 11 out of 32 successfully perturbed\n","apgd-ce - 4/30 - 15 out of 32 successfully perturbed\n","apgd-ce - 5/30 - 8 out of 32 successfully perturbed\n","apgd-ce - 6/30 - 5 out of 32 successfully perturbed\n","apgd-ce - 7/30 - 19 out of 32 successfully perturbed\n","apgd-ce - 8/30 - 13 out of 32 successfully perturbed\n","apgd-ce - 9/30 - 15 out of 32 successfully perturbed\n","apgd-ce - 10/30 - 9 out of 32 successfully perturbed\n","apgd-ce - 11/30 - 10 out of 32 successfully perturbed\n","apgd-ce - 12/30 - 10 out of 32 successfully perturbed\n","apgd-ce - 13/30 - 12 out of 32 successfully perturbed\n","apgd-ce - 14/30 - 9 out of 32 successfully perturbed\n","apgd-ce - 15/30 - 8 out of 32 successfully perturbed\n","apgd-ce - 16/30 - 9 out of 32 successfully perturbed\n","apgd-ce - 17/30 - 8 out of 32 successfully perturbed\n","apgd-ce - 18/30 - 13 out of 32 successfully perturbed\n","apgd-ce - 19/30 - 11 out of 32 successfully perturbed\n","apgd-ce - 20/30 - 12 out of 32 successfully perturbed\n","apgd-ce - 21/30 - 18 out of 32 successfully perturbed\n","apgd-ce - 22/30 - 10 out of 32 successfully perturbed\n","apgd-ce - 23/30 - 14 out of 32 successfully perturbed\n","apgd-ce - 24/30 - 11 out of 32 successfully perturbed\n","apgd-ce - 25/30 - 9 out of 32 successfully perturbed\n","apgd-ce - 26/30 - 14 out of 32 successfully perturbed\n","apgd-ce - 27/30 - 7 out of 32 successfully perturbed\n","apgd-ce - 28/30 - 4 out of 32 successfully perturbed\n","apgd-ce - 29/30 - 12 out of 32 successfully perturbed\n","apgd-ce - 30/30 - 4 out of 16 successfully perturbed\n","robust accuracy after APGD-CE: 61.43% (total time 320.0 s)\n","apgd-t - 1/20 - 2 out of 32 successfully perturbed\n","apgd-t - 2/20 - 3 out of 32 successfully perturbed\n","apgd-t - 3/20 - 5 out of 32 successfully perturbed\n","apgd-t - 4/20 - 6 out of 32 successfully perturbed\n","apgd-t - 5/20 - 3 out of 32 successfully perturbed\n","apgd-t - 6/20 - 5 out of 32 successfully perturbed\n","apgd-t - 7/20 - 4 out of 32 successfully perturbed\n","apgd-t - 8/20 - 3 out of 32 successfully perturbed\n","apgd-t - 9/20 - 3 out of 32 successfully perturbed\n","apgd-t - 10/20 - 7 out of 32 successfully perturbed\n","apgd-t - 11/20 - 4 out of 32 successfully perturbed\n","apgd-t - 12/20 - 4 out of 32 successfully perturbed\n","apgd-t - 13/20 - 4 out of 32 successfully perturbed\n","apgd-t - 14/20 - 7 out of 32 successfully perturbed\n","apgd-t - 15/20 - 4 out of 32 successfully perturbed\n","apgd-t - 16/20 - 6 out of 32 successfully perturbed\n","apgd-t - 17/20 - 8 out of 32 successfully perturbed\n","apgd-t - 18/20 - 2 out of 32 successfully perturbed\n","apgd-t - 19/20 - 5 out of 32 successfully perturbed\n","apgd-t - 20/20 - 1 out of 21 successfully perturbed\n","robust accuracy after APGD-T: 53.03% (total time 2080.9 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 53.03%\n"]}],"source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/pgd_dgcnn_run_1/model_best_test.pth --exp-config configs/pgd/dgcnn.yaml --epsilon=0.05"],"id":"R4wk1iPrdNjk"},{"cell_type":"markdown","source":["pgd_pct_run_1"],"metadata":{"id":"nFK09bEWJ0CO"},"id":"nFK09bEWJ0CO"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/pgd_pct_run_1/model_best_test.pth --exp-config configs/pgd/pct.yaml --epsilon=0.05"],"metadata":{"id":"O_jUpoE4J0S_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701771638017,"user_tz":480,"elapsed":11893,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"9c4ce4b5-811e-4b96-a23b-3682711e0bda"},"id":"O_jUpoE4J0S_","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: pgd\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: pgd_pct_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pct\n","  OPTIMIZER: pct\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0001\n","  learning_rate: 0.0001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Pct(\n","  (model): Pct(\n","    (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (conv2): Conv1d(64, 64, kernel_size=(1,), stride=(1,), bias=False)\n","    (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (gather_local_0): Local_op(\n","      (conv1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (gather_local_1): Local_op(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (pt_last): Point_Transformer_Last(\n","      (conv1): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (conv2): Conv1d(256, 256, kernel_size=(1,), stride=(1,), bias=False)\n","      (bn1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (sa1): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa2): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa3): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","      (sa4): SA_Layer(\n","        (q_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (k_conv): Conv1d(256, 64, kernel_size=(1,), stride=(1,), bias=False)\n","        (v_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (trans_conv): Conv1d(256, 256, kernel_size=(1,), stride=(1,))\n","        (after_norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (act): ReLU()\n","        (softmax): Softmax(dim=-1)\n","      )\n","    )\n","    (conv_fuse): Sequential(\n","      (0): Conv1d(1280, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=1024, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/pgd_pct_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py:52: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)\n","  output = torch.cuda.IntTensor(B, npoint)\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 736, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/pct.py\", line 29, in forward\n","    logit = self.model(pc)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/model.py\", line 59, in forward\n","    new_xyz, new_feature = sample_and_group(npoint=512, radius=0.15, nsample=32, xyz=xyz, points=x)         \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/util.py\", line 127, in sample_and_group\n","    fps_idx = pointnet2_utils.furthest_point_sample(xyz, npoint).long() # [B, npoint]\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_utils.py\", line 54, in forward\n","    pointnet2.furthest_point_sampling_wrapper(\n","AttributeError: module '_ext.pointnet2' has no attribute 'furthest_point_sampling_wrapper'\n"]}]},{"cell_type":"markdown","source":["pgd_pointnet_run_1"],"metadata":{"id":"oGinkAx7KZQL"},"id":"oGinkAx7KZQL"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/pgd_pointnet_run_1/model_best_test.pth --exp-config configs/pgd/pointnet.yaml --epsilon=0.05"],"metadata":{"id":"7qlcIMa7KZpT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701841843201,"user_tz":480,"elapsed":410150,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"189cf4a1-008f-477d-d77d-e6657ba546ca"},"id":"7qlcIMa7KZpT","execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: pgd\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: pgd_pointnet_run1_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls_trans\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","PointNet(\n","  (model): PointNetCls(\n","    (feat): PointNetfeat(\n","      (stn): STN3d(\n","        (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=9, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","      (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","      (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","      (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","      (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (fstn): STNkd(\n","        (conv1): Conv1d(64, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=4096, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","    )\n","    (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","    (fc2): Linear(in_features=512, out_features=256, bias=True)\n","    (fc3): Linear(in_features=256, out_features=40, bias=True)\n","    (dropout): Dropout(p=0.3, inplace=False)\n","    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (relu): ReLU()\n","  )\n",")\n","Recovering model and checkpoint from runs/pgd_pointnet_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 87.30%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/28 - 13 out of 32 successfully perturbed\n","apgd-ce - 2/28 - 15 out of 32 successfully perturbed\n","apgd-ce - 3/28 - 19 out of 32 successfully perturbed\n","apgd-ce - 4/28 - 20 out of 32 successfully perturbed\n","apgd-ce - 5/28 - 16 out of 32 successfully perturbed\n","apgd-ce - 6/28 - 17 out of 32 successfully perturbed\n","apgd-ce - 7/28 - 15 out of 32 successfully perturbed\n","apgd-ce - 8/28 - 21 out of 32 successfully perturbed\n","apgd-ce - 9/28 - 16 out of 32 successfully perturbed\n","apgd-ce - 10/28 - 19 out of 32 successfully perturbed\n","apgd-ce - 11/28 - 15 out of 32 successfully perturbed\n","apgd-ce - 12/28 - 21 out of 32 successfully perturbed\n","apgd-ce - 13/28 - 19 out of 32 successfully perturbed\n","apgd-ce - 14/28 - 20 out of 32 successfully perturbed\n","apgd-ce - 15/28 - 19 out of 32 successfully perturbed\n","apgd-ce - 16/28 - 12 out of 32 successfully perturbed\n","apgd-ce - 17/28 - 24 out of 32 successfully perturbed\n","apgd-ce - 18/28 - 22 out of 32 successfully perturbed\n","apgd-ce - 19/28 - 24 out of 32 successfully perturbed\n","apgd-ce - 20/28 - 19 out of 32 successfully perturbed\n","apgd-ce - 21/28 - 18 out of 32 successfully perturbed\n","apgd-ce - 22/28 - 22 out of 32 successfully perturbed\n","apgd-ce - 23/28 - 21 out of 32 successfully perturbed\n","apgd-ce - 24/28 - 22 out of 32 successfully perturbed\n","apgd-ce - 25/28 - 18 out of 32 successfully perturbed\n","apgd-ce - 26/28 - 18 out of 32 successfully perturbed\n","apgd-ce - 27/28 - 13 out of 32 successfully perturbed\n","apgd-ce - 28/28 - 16 out of 30 successfully perturbed\n","robust accuracy after APGD-CE: 37.11% (total time 63.9 s)\n","apgd-t - 1/12 - 7 out of 32 successfully perturbed\n","apgd-t - 2/12 - 4 out of 32 successfully perturbed\n","apgd-t - 3/12 - 9 out of 32 successfully perturbed\n","apgd-t - 4/12 - 11 out of 32 successfully perturbed\n","apgd-t - 5/12 - 5 out of 32 successfully perturbed\n","apgd-t - 6/12 - 3 out of 32 successfully perturbed\n","apgd-t - 7/12 - 5 out of 32 successfully perturbed\n","apgd-t - 8/12 - 6 out of 32 successfully perturbed\n","apgd-t - 9/12 - 7 out of 32 successfully perturbed\n","apgd-t - 10/12 - 7 out of 32 successfully perturbed\n","apgd-t - 11/12 - 6 out of 32 successfully perturbed\n","apgd-t - 12/12 - 2 out of 28 successfully perturbed\n","robust accuracy after APGD-T: 30.08% (total time 304.3 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 30.08%\n"]}]},{"cell_type":"markdown","source":["rsmix_dgcnn_run_1"],"metadata":{"id":"6ujMd-KPLAB1"},"id":"6ujMd-KPLAB1"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/rsmix_dgcnn_run_1/model_best_test.pth --exp-config configs/rsmix/dgcnn.yaml --epsilon=0.05"],"metadata":{"id":"P6gA5H8uLAW3","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701772288136,"user_tz":480,"elapsed":350314,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"af860eec-c40c-44df-d453-1f3924cf2fa5"},"id":"P6gA5H8uLAW3","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: rsmix\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: rsmix_dgcnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: dgcnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","DGCNN(\n","  (model): DGCNN(\n","    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn3): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn5): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (conv1): Sequential(\n","      (0): Conv2d(6, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv2): Sequential(\n","      (0): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv3): Sequential(\n","      (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv4): Sequential(\n","      (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (conv5): Sequential(\n","      (0): Conv1d(512, 1024, kernel_size=(1,), stride=(1,), bias=False)\n","      (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (2): LeakyReLU(negative_slope=0.2)\n","    )\n","    (linear1): Linear(in_features=2048, out_features=512, bias=False)\n","    (bn6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp1): Dropout(p=0.5, inplace=False)\n","    (linear2): Linear(in_features=512, out_features=256, bias=True)\n","    (bn7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (dp2): Dropout(p=0.5, inplace=False)\n","    (linear3): Linear(in_features=256, out_features=40, bias=True)\n","  )\n",")\n","Recovering model and checkpoint from runs/rsmix_dgcnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 92.38%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 2/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 3/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 4/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 5/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 6/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 7/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 8/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 9/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 10/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 11/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 12/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 13/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 14/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 15/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 16/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 17/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 18/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 19/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 20/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 21/30 - 31 out of 32 successfully perturbed\n","apgd-ce - 22/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 23/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 24/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 25/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 26/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 27/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 28/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 29/30 - 32 out of 32 successfully perturbed\n","apgd-ce - 30/30 - 18 out of 18 successfully perturbed\n","robust accuracy after APGD-CE: 0.20% (total time 321.4 s)\n","apgd-t - 1/1 - 1 out of 2 successfully perturbed\n","robust accuracy after APGD-T: 0.10% (total time 335.6 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.10%\n"]}]},{"cell_type":"markdown","source":["rsmix_pct_run_1"],"metadata":{"id":"zBFTCV_lLLSF"},"id":"zBFTCV_lLLSF"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/rsmix_pct_run_1/model_best_test.pth --exp-config configs/rsmix/pct.yaml --epsilon=0.05"],"metadata":{"id":"_qKgidXuLLeC"},"id":"_qKgidXuLLeC","execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["rsmix_pointnet2_run_1"],"metadata":{"id":"la4rTx1fLgX6"},"id":"la4rTx1fLgX6"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/rsmix_pointnet2_run_1/model_best_test.pth --exp-config configs/rsmix/pointnet2.yaml --epsilon=0.05"],"metadata":{"id":"ubwAhL-FLgtc"},"id":"ubwAhL-FLgtc","execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["rsmix_pointnet_run_1\n"],"metadata":{"id":"XhITSxc-MQ-o"},"id":"XhITSxc-MQ-o"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/rsmix_pointnet_run_1/model_best_test.pth --exp-config configs/rsmix/pointnet.yaml --epsilon=0.05"],"metadata":{"id":"Ohqv7rfZMRNR","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701772410838,"user_tz":480,"elapsed":101138,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"2553f22f-ca25-40f8-b26e-57571dcf766b"},"id":"Ohqv7rfZMRNR","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: rsmix\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: rsmix_pointnet_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: pointnet\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls_trans\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","PointNet(\n","  (model): PointNetCls(\n","    (feat): PointNetfeat(\n","      (stn): STN3d(\n","        (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=9, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","      (conv1): Conv1d(3, 64, kernel_size=(1,), stride=(1,))\n","      (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","      (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","      (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      (fstn): STNkd(\n","        (conv1): Conv1d(64, 64, kernel_size=(1,), stride=(1,))\n","        (conv2): Conv1d(64, 128, kernel_size=(1,), stride=(1,))\n","        (conv3): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))\n","        (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","        (fc2): Linear(in_features=512, out_features=256, bias=True)\n","        (fc3): Linear(in_features=256, out_features=4096, bias=True)\n","        (relu): ReLU()\n","        (bn1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn3): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        (bn5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","      )\n","    )\n","    (fc1): Linear(in_features=1024, out_features=512, bias=True)\n","    (fc2): Linear(in_features=512, out_features=256, bias=True)\n","    (fc3): Linear(in_features=256, out_features=40, bias=True)\n","    (dropout): Dropout(p=0.3, inplace=False)\n","    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (relu): ReLU()\n","  )\n",")\n","Recovering model and checkpoint from runs/rsmix_pointnet_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","initial accuracy: 89.84%\n","torch.Size([1024, 1024, 3])\n","apgd-ce - 1/29 - 27 out of 32 successfully perturbed\n","apgd-ce - 2/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 3/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 4/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 5/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 6/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 7/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 8/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 9/29 - 27 out of 32 successfully perturbed\n","apgd-ce - 10/29 - 32 out of 32 successfully perturbed\n","apgd-ce - 11/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 12/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 13/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 14/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 15/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 16/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 17/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 18/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 19/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 20/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 21/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 22/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 23/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 24/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 25/29 - 30 out of 32 successfully perturbed\n","apgd-ce - 26/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 27/29 - 31 out of 32 successfully perturbed\n","apgd-ce - 28/29 - 29 out of 32 successfully perturbed\n","apgd-ce - 29/29 - 22 out of 24 successfully perturbed\n","robust accuracy after APGD-CE: 5.47% (total time 62.3 s)\n","apgd-t - 1/2 - 29 out of 32 successfully perturbed\n","apgd-t - 2/2 - 20 out of 24 successfully perturbed\n","robust accuracy after APGD-T: 0.68% (total time 88.2 s)\n","max Linf perturbation: 0.05000, nan in tensor: 0, max: 1.00000, min: -1.00000\n","robust accuracy: 0.68%\n"]}]},{"cell_type":"markdown","source":["rsmix_rscnn_run_1"],"metadata":{"id":"SmMOqmTDMi7Y"},"id":"SmMOqmTDMi7Y"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/rsmix_rscnn_run_1/model_best_test.pth --exp-config configs/rsmix/rscnn.yaml --epsilon=0.05"],"metadata":{"id":"tUFL633YMjKi","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701841918977,"user_tz":480,"elapsed":17022,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"a58f1c44-fa68-4a16-f04e-158a9391ede8"},"id":"tUFL633YMjKi","execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: rsmix\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: rsmix_rscnn_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: rscnn\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","RSCNN(\n","  (model): RSCNN_SSN(\n","    (SA_modules): ModuleList(\n","      (0): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 64, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(16, 128, kernel_size=(1,), stride=(1,))\n","                (xyz_raising): Conv2d(3, 16, kernel_size=(1, 1), stride=(1, 1))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (1): PointnetSAModuleMSG(\n","        (groupers): ModuleList(\n","          (0): QueryAndGroup()\n","        )\n","        (mlps): ModuleList(\n","          (0): SharedRSConv(\n","            (RSConvLayer0): RSConvLayer(\n","              (RS_Conv): RSConv(\n","                (bn_rsconv): BatchNorm2d(131, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_channel_raising): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_xyz_raising): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (bn_mapping): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","                (activation): ReLU(inplace=True)\n","                (mapping_func1): Conv2d(10, 128, kernel_size=(1, 1), stride=(1, 1))\n","                (mapping_func2): Conv2d(128, 131, kernel_size=(1, 1), stride=(1, 1))\n","                (cr_mapping): Conv1d(131, 512, kernel_size=(1,), stride=(1,))\n","              )\n","            )\n","          )\n","        )\n","      )\n","      (2): PointnetSAModule(\n","        (groupers): ModuleList(\n","          (0): GroupAll()\n","        )\n","        (mlps): ModuleList(\n","          (0): GloAvgConv(\n","            (conv_avg): Conv2d(515, 1024, kernel_size=(1, 1), stride=(1, 1))\n","            (bn_avg): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","            (activation): ReLU(inplace=True)\n","          )\n","        )\n","      )\n","    )\n","    (FC_layer): Sequential(\n","      (0): FC(\n","        (fc): Linear(in_features=1024, out_features=512, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (1): Dropout(p=0.5, inplace=False)\n","      (2): FC(\n","        (fc): Linear(in_features=512, out_features=256, bias=False)\n","        (bn): BatchNorm1d(\n","          (bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","        )\n","        (activation): ReLU(inplace=True)\n","      )\n","      (3): Dropout(p=0.5, inplace=False)\n","      (4): FC(\n","        (fc): Linear(in_features=256, out_features=40, bias=True)\n","      )\n","    )\n","  )\n",")\n","Recovering model and checkpoint from runs/rsmix_rscnn_run_1/model_best_test.pth\n","EPSILON\n","0.05\n","setting parameters for standard version\n","using standard version including apgd-ce, apgd-t.\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 895, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 738, in entry_attack\n","    adv_complete = adversary.run_standard_evaluation(x_test[:n_ex], y_test[:n_ex], bs=batch_size)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 113, in run_standard_evaluation\n","    checks.check_randomized(self.get_logits, x_orig[:bs].to(self.device),\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/checks.py\", line 24, in check_randomized\n","    output = model(x)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/../auto-attack/autoattack/autoattack.py\", line 74, in get_logits\n","    return self.model(x)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/rscnn.py\", line 39, in forward\n","    out = {'logit': self.model(pc)}\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/rscnn_ssn_cls.py\", line 96, in forward\n","    xyz, features = module(xyz, features)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","    return self._call_impl(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","    return forward_call(*args, **kwargs)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/rs_cnn/models/../utils/pointnet2_modules_updated.py\", line 146, in forward\n","    fps_idx = tp.furthest_point_sample(xyz, self.npoint)  # (B, npoint)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","    return super().apply(*args, **kwargs)  # type: ignore[misc]\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/PCT_Pytorch/pointnet2_ops_lib/pointnet2_ops/pointnet2_utils.py\", line 55, in forward\n","    out = _ext.furthest_point_sampling(xyz, npoint)\n","NameError: name '_ext' is not defined. Did you mean: 'Text'?\n"]}]},{"cell_type":"markdown","source":["rsmix_simpleview_run_1"],"metadata":{"id":"8bbqYY6XM4eF"},"id":"8bbqYY6XM4eF"},{"cell_type":"code","source":["!CUDA_LAUNCH_BLOCKING=1 python main.py --entry attack --model-path runs/rsmix_simpleview_run_1/model_best_test.pth --exp-config configs/rsmix/simpleview.yaml --epsilon=0.05"],"metadata":{"id":"8FxOdTapM4pR","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701772431403,"user_tz":480,"elapsed":17,"user":{"displayName":"Edward Yeung","userId":"15709190475961605602"}},"outputId":"5318b54c-433b-4eab-88e8-00eaaae51492"},"id":"8FxOdTapM4pR","execution_count":null,"outputs":[{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["ADAPT:\n","  ITER: 1\n","  METHOD: none\n","AUG:\n","  BETA: 1.0\n","  MIXUPRATE: 0.4\n","  NAME: rsmix\n","  PROB: 0.5\n","DATALOADER:\n","  MODELNET40_C:\n","    corruption: uniform\n","    severity: 1\n","    test_data_path: ./data/modelnet40_c/\n","  MODELNET40_DGCNN:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_PN2:\n","    num_points: 1024\n","    test_data_path: ./data/modelnet40_ply_hdf5_2048/test_files.txt\n","    train_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","    valid_data_path: ./data/modelnet40_ply_hdf5_2048/train_files.txt\n","  MODELNET40_RSCNN:\n","    data_path: ./data/\n","    num_points: 1024\n","    test_data_path: test_files.txt\n","    train_data_path: train_files.txt\n","    valid_data_path: train_files.txt\n","  batch_size: 32\n","  num_workers: 0\n","EXP:\n","  DATASET: modelnet40_dgcnn\n","  EXP_ID: rsmix_simpleview_run_1\n","  LOSS_NAME: smooth\n","  METRIC: acc\n","  MODEL_NAME: simpleview\n","  OPTIMIZER: vanilla\n","  SEED: 1\n","  TASK: cls\n","EXP_EXTRA:\n","  no_test: False\n","  no_val: True\n","  save_ckp: 25\n","  test_eval_freq: 1\n","  val_eval_freq: 1\n","MODEL:\n","  MV:\n","    backbone: resnet18\n","    feat_size: 16\n","  PN2:\n","    version_cls: 1.0\n","  RSCNN:\n","    ssn_or_msn: True\n","TRAIN:\n","  early_stop: 300\n","  l2: 0.0\n","  learning_rate: 0.001\n","  lr_clip: 1e-05\n","  lr_decay_factor: 0.5\n","  lr_reduce_patience: 10\n","  num_epochs: 300\n","Traceback (most recent call last):\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 893, in <module>\n","    entry_attack(cfg, cmd_args.norm, cmd_args.epsilon, cmd_args.batch_size, \n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 703, in entry_attack\n","    model = get_model(cfg)\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/main.py\", line 411, in get_model\n","    model = models.MVModel(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 23, in __init__\n","    img_layers, in_features = self.get_img_layers(\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/mv.py\", line 63, in get_img_layers\n","    from models.resnet import _resnet, BasicBlock\n","  File \"/content/drive/.shortcut-targets-by-id/13c6fMYtl5e-60Uej23p2ItJRgTm7trhw/project/ModelNet40c/models/resnet.py\", line 3, in <module>\n","    from torchvision.models.utils import load_state_dict_from_url\n","ModuleNotFoundError: No module named 'torchvision.models.utils'\n"]}]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[],"gpuType":"V100","machine_shape":"hm"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":5}